# Plotly_Charts Library

This is a modular pipeline to generate plotly figures from pandas data.

## Overview

This modular pipeline contains several standard plots that are used in many different studies. Each can be generated by 
providing only data and parameters to the pipeline.



## Scatter plot

Creates a scatter plot between two variables in a given data frame. Optionally, you can provide a colour and size variable.


### Parameters

You must provide the following parameters in your `parameters.yml` file:

```yaml
scatter_plot:
    fig:
        x: mill_b_power
        y: outp_quantity
    layout:
        title: 'mill power vs output'
```

### Pipeline

The following pipeline example will create the plot.

```python
from core_pipelines.pipelines import plotly_charts

pipeline(
    pipe=plotly_charts.create_pipeline().only_nodes("scatter_plot"),              # name of plot to create
    inputs={"data": "my_data"},                                           # map input data
    outputs={"scatter_plot": "my_plot"},                                          # map output plot
    parameters={"params:scatter_plot": "params:scatter_plot"}                     # provide params
)
```



## Box plot

Creates a box plot for the specified column in the given input dataframe.

### Parameters

You must provide the following parameters in your `parameters.yml` file:

```yaml
box_plot:
    fig:
        y: 'cu_content' # The variable to plot
    layout: # optional params to customize plot layout
        template: plotly_dark
```


### Pipeline

The following pipeline example will create the plot.

```python
from core_pipelines.pipelines import plotly_charts

pipeline(
    pipe=plotly_charts.create_pipeline().only_nodes("box_plot"),              # name of plot to create
    inputs={"data": "my_data"},                                           # map input data
    outputs={"box_plot": "my_plot"},                                          # map output plot
    parameters={"params:box_plot": "params:box_plot"}                         # provide params
)
```


## Actual vs predicted plot

Plots actual value vs predicted value, with a trend line between them.


### Parameters

You must provide the following parameters in your `parameters.yml` file:

```yaml
actual_vs_predicted_plot:
    prediction_col: inp_quantity # Column name of predictions
    target_col: outp_quantity # target column
    layout: # optional settings to customize the plot layout
        template: plotly_dark
        showlegend: True
```

### Pipeline

The following pipeline example will create the plot.

```python
from core_pipelines.pipelines import plotly_charts

pipeline(
    pipe=plotly_charts.create_pipeline().only_nodes("actual_vs_predicted"),           # name of plot to create
    inputs={"data": "my_data"},                                   # map input data
    outputs={"actual_vs_predicted_plot": "my_plot"},                                  # map output plot
    parameters={"params:actual_vs_predicted_plot": "params:actual_vs_predicted_plot"} # provide params
)
```


## Timeline plot

Plots the timeline of each specified column based on a given timestamp column.


### Parameters

You must provide the following parameters in your `parameters.yml` file:

```yaml
timeline_plot:
  fig: 
      x: timestmap # name of column holding timestamp
      y: [outp_quantity, inp_quantity] # Columns to plot traces of
  layout: # options to customize plot layout
      title: "My Plot Title" # TITLE OF THE FIGURE
```

### Pipeline

The following pipeline example will create the plot.

```python
from core_pipelines.pipelines import plotly_charts

pipeline(
    pipe=plotly_charts.create_pipeline().only_nodes("timeline"),           # name of plot to create
    inputs={"data": "my_data"},                                   # map input data
    outputs={"timeline_plot": "my_plot"},                                  # map output plot
    parameters={"params:timeline_plot": "params:timeline_plot"}            # provide params
)
```

## Feature Overview plot

A collection of plots of a given feature, to understand its distribution and 
any relationships to the target variable. Includes a timeline plot, a box plot,
a histogram and a scatterplot vs the target variable.


### Parameters

You must provide the following parameters in your `parameters.yml` file:

```yaml
feature_overview:
    feature_name: inp_quantity
    target_name: outp_quantity
    timestamp_name: timestamp
    layout: # options to customize plot layout
        title: "My Plot Title" # TITLE OF THE FIGURE
```

### Pipeline

The following pipeline example will create the plot.

```python
from core_pipelines.pipelines import plotly_charts

pipeline(
    pipe=plotly_charts.create_pipeline().only_nodes("overview"),           # name of plot to create
    inputs={"data": "my_data"},                                   # map input data
    outputs={"feature_overview": "my_plot"},                                  # map output plot
    parameters={"params:feature_overview": "params:feature_overview"}            # provide params
)
```

